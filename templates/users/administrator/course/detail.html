{% extends '../_base.html' %}
{% load static %}

{% block title %}{{ course.title }} - LMS Admin{% endblock %}

{% block extra_css %}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap');

    body {
        font-family: 'Poppins', sans-serif;
        background-color: #f0f0f0;
        color: #333;
    }
    h1, h2, h3, h4, h5, h6 {
        font-family: 'Playfair Display', serif;
    }
    .bg-primary { background-color: #1e3a8a; }
    .bg-secondary { background-color: #f9fafb; }
    .bg-accent { background-color: #c2410c; }
    .text-primary { color: #1e3a8a; }
    .text-secondary { color: #4b5563; }
    .text-accent { color: #c2410c; }
    .border-primary { border-color: #1e3a8a; }
    .hover-bg-accent:hover { background-color: #9a3412; }
    .gradient-bg {
        background: linear-gradient(135deg, #1e3a8a, #3b82f6);
    }
    .card-shadow {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    .tab-content {
        display: none;
    }
    .tab-content.active {
        display: block;
    }
</style>
<link href="https://unpkg.com/aos@next/dist/aos.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container mx-auto">
    <!-- Header -->
    <header class="mb-6 gradient-bg p-6 rounded-lg shadow-md">
        <h1 class="text-4xl font-bold text-white text-center mb-2">{{ course.title }}</h1>
        <p class="text-xl text-blue-100 text-center">Course ID: {{ course.id }}</p>
    </header>
    
    <!-- Breadcrumbs -->
    <nav class="flex mb-4" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a href="#" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
                    Dashboard
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                    <a href="#" class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2">Courses</a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                    <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">{{ course.title }}</span>
                </div>
            </li>
        </ol>
    </nav>

    <div class="flex flex-wrap -mx-4">
        <!-- Left Column -->
        <div class="w-full lg:w-1/3 px-4 mb-8">
            <div class="bg-white rounded-lg card-shadow overflow-hidden">
                {% if course.cover_image %}
                    <img src="{{ course.cover_image.url }}" alt="{{ course.title }}" class="w-full h-48 object-cover">
                {% else %}
                    <div class="w-full h-48 bg-gray-300 flex items-center justify-center">
                        <span class="text-gray-500">No Cover Image</span>
                    </div>
                {% endif %}
                <div class="p-6">
                    <h2 class="text-2xl font-bold text-primary mb-2">{{ course.title }}</h2>
                    <p class="text-secondary mb-4">Course ID: {{ course.id }}</p>
                    <div class="flex justify-between mb-4">
                        <button class="bg-primary text-white px-4 py-2 rounded hover:bg-blue-700 transition">Edit Course</button>
                        <button class="bg-accent text-white px-4 py-2 rounded hover:bg-red-700 transition">Unpublish</button>
                    </div>
                    <div class="flex justify-between mb-4">
                        <button onclick="previewResource()" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300 transition">Preview</button>
                        <button class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300 transition">Analytics</button>
                    </div>
                    <div class="mt-6">
                        <h3 class="text-xl font-semibold mb-4">Quick Actions</h3>
                        <ul class="space-y-2">
                            <li><a href="#" class="text-blue-600 hover:underline"><i class="fas fa-user-plus mr-2"></i>Add New Student</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline"><i class="fas fa-calendar-alt mr-2"></i>Schedule Live Session</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline"><i class="fas fa-chart-bar mr-2"></i>Generate Report</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline"><i class="fas fa-envelope mr-2"></i>Send Announcement</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column -->
        <div class="w-full lg:w-2/3 px-4">
            <div class="bg-white rounded-lg card-shadow p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">Course Overview</h2>
                <p class="mb-4">{{ course.description }}</p>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p><strong>Category:</strong> {{ course.category }}</p>
                        <p><strong>Created by:</strong> {{ course.created_by }}</p>
                        <p><strong>Last Updated:</strong> {{ course.updated_at|date:"F d, Y" }}</p>
                    </div>
                    <div>
                        <p><strong>Total Enrollments:</strong> {{ total_enrollments }}</p>
                        <p><strong>Active Enrollments:</strong> {{ total_active_enrollments }}</p>
                        <p><strong>Course Deliveries:</strong> {{ total_deliveries }}</p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg card-shadow p-6">
                <ul class="flex border-b border-gray-200 mb-6" id="mainTabs">
                    <li class="mr-1">
                        <a class="bg-white inline-block py-2 px-4 text-blue-500 hover:text-blue-800 font-semibold active" href="#" data-tab="content">
                            Course Content
                        </a>
                    </li>
                    <li class="mr-1">
                        <a class="bg-white inline-block py-2 px-4 text-blue-500 hover:text-blue-800 font-semibold" href="#" data-tab="enrollments">
                            Enrollments
                        </a>
                    </li>
                    <li class="mr-1">
                        <a class="bg-white inline-block py-2 px-4 text-blue-500 hover:text-blue-800 font-semibold" href="#" data-tab="deliveries">
                            Course Deliveries
                        </a>
                    </li>
                </ul>

                <div id="content" class="tab-content active">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold">Course Content</h3>
                        <button class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition" onclick="showAddResourceModal()">
                            <i class="fas fa-plus mr-2"></i>Add New Resource
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="px-4 py-2 text-left">Title</th>
                                    <th class="px-4 py-2 text-left">Type</th>
                                    <th class="px-4 py-2 text-left">Order</th>
                                    <th class="px-4 py-2 text-left">Last Updated</th>
                                    <th class="px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for resource in learning_resources %}
                                <tr>
                                    <td class="px-4 py-2">
                                        <div class="flex items-center">
                                            <span class="resource-type-icon w-8 h-8 rounded-full flex items-center justify-center mr-2
                                                {% if resource.resource_type == 'SCORM' %}
                                                    bg-blue-100 text-blue-600
                                                {% elif resource.resource_type == 'VIDEO' %}
                                                    bg-red-100 text-red-600
                                                {% elif resource.resource_type == 'DOCUMENT' %}
                                                    bg-yellow-100 text-yellow-600
                                                {% elif resource.resource_type == 'PRESENTATION' %}
                                                    bg-orange-100 text-orange-600
                                                {% elif resource.resource_type == 'LINK' %}
                                                    bg-purple-100 text-purple-600
                                                {% elif resource.resource_type == 'QUIZ' %}
                                                    bg-green-100 text-green-600
                                                {% else %}
                                                    bg-gray-100 text-gray-600
                                                {% endif %}">
                                                <i class="fas fa-{{ resource.get_resource_type_display|lower }}-alt"></i>
                                            </span>
                                            {{ resource.title }}
                                        </div>
                                    </td>
                                    <td class="px-4 py-2">{{ resource.get_resource_type_display }}</td>
                                    <td class="px-4 py-2">{{ resource.order }}</td>
                                    <td class="px-4 py-2">{{ resource.updated_at|date:"F d, Y" }}</td>
                                    <td class="px-4 py-2">
                                        <button class="text-blue-500 hover:text-blue-700 mr-2" onclick="editResource('{{ resource.id }}')"><i class="fas fa-edit"></i></button>
                                        <button class="text-green-500 hover:text-green-700 mr-2" onclick="previewResource('{{ resource.id }}')"><i class="fas fa-eye"></i></button>
                                        <button class="text-red-500 hover:text-red-700" onclick="deleteResource('{{ resource.id }}')"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="enrollments" class="tab-content">
                    <h3 class="text-xl font-semibold mb-4">Recent Enrollments</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-2 px-4 text-left">User</th>
                                    <th class="py-2 px-4 text-left">Delivery</th>
                                    <th class="py-2 px-4 text-left">Enrollment Date</th>
                                    <th class="py-2 px-4 text-left">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for enrollment in recent_enrollments %}
                                <tr>
                                    <td class="py-2 px-4">{{ enrollment.user.username }}</td>
                                    <td class="py-2 px-4">{{ enrollment.course_delivery.title }}</td>
                                    <td class="py-2 px-4">{{ enrollment.enrollment_date|date:"F d, Y H:i" }}</td>
                                    <td class="py-2 px-4">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                            {% if enrollment.status == 'ENROLLED' %}
                                                bg-green-100 text-green-800
                                            {% elif enrollment.status == 'IN_PROGRESS' %}
                                                bg-blue-100 text-blue-800
                                            {% elif enrollment.status == 'COMPLETED' %}
                                                bg-purple-100 text-purple-800
                                            {% else %}
                                                bg-red-100 text-red-800
                                            {% endif %}">
                                            {{ enrollment.get_status_display }}
                                        </span>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="deliveries" class="tab-content">
                    <h3 class="text-xl font-semibold mb-4">Course Deliveries</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-2 px-4 text-left">Title</th>
                                    <th class="py-2 px-4 text-left">Start Date</th>
                                    <th class="py-2 px-4 text-left">Total Enrollments</th>
                                    <th class="py-2 px-4 text-left">Active Enrollments</th>
                                    <th class="py-2 px-4 text-left">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for delivery in course_deliveries %}
                                <tr>
                                    <td class="py-2 px-4">{{ delivery.title }}</td>
                                    <td class="py-2 px-4">{{ delivery.start_date|date:"F d, Y" }}</td>
                                    <td class="py-2 px-4">{{ delivery.total_enrollments }}</td>
                                    <td class="py-2 px-4">{{ delivery.active_enrollments }}</td>
                                    <td class="py-2 px-4">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                            {% if delivery.status == 'ACTIVE' %}
                                                bg-green-100 text-green-800
                                            {% elif delivery.status == 'DRAFT' %}
                                                bg-yellow-100 text-yellow-800
                                            {% elif delivery.status == 'COMPLETED' %}
                                                bg-blue-100 text-blue-800
                                            {% else %}
                                                bg-gray-100 text-gray-800
                                            {% endif %}">
                                            {{ delivery.get_status_display }}
                                        </span>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Resource Modal -->
<div id="addResourceModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden justify-center items-center">
    <div class="bg-white rounded-lg p-8 max-w-md w-full">
        <h2 class="text-2xl font-semibold mb-4">Add New Resource</h2>
        <form>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                <input type="text" class="w-full px-3 py-2 border rounded-md">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Resource Type</label>
                <select class="w-full px-3 py-2 border rounded-md">
                    <option>SCORM Package</option>
                    <option>Video</option>
                    <option>Document</option>
                    <option>Presentation</option>
                    <option>External Link</option>
                    <option>Quiz</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea class="w-full px-3 py-2 border rounded-md" rows="3"></textarea>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Content File</label>
                <input type="file" class="w-full px-3 py-2 border rounded-md">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Order</label>
                <input type="number" class="w-full px-3 py-2 border rounded-md" min="1">
            </div>
            <div class="flex justify-end">
                <button type="button" class="bg-gray-300 text-gray-800 px-4 py-2 rounded mr-2" onclick="closeAddResourceModal()">Cancel</button>
                <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Add Resource</button>
            </div>
        </form>
    </div>
</div>

<!-- Preview Modal -->
<div id="previewModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
    <div class="modal-backdrop absolute inset-0"></div>
    <div class="bg-white w-11/12 h-5/6 rounded-lg shadow-2xl z-10 overflow-hidden flex" data-aos="zoom-in">
        <!-- Learning Path Sidebar -->
        <div class="w-1/3 bg-gray-50 p-6 overflow-auto border-r">
            <h3 class="text-xl font-bold mb-4">Learning Path</h3>
            <div id="learningPath" class="space-y-4">
                <!-- Learning path items will be inserted here -->
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="w-2/3 flex flex-col">
            <div class="flex justify-between items-center p-6 bg-gray-50 border-b">
                <h3 class="text-2xl font-bold text-gray-800" id="modalTitle">Course Resource Preview</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 transition duration-150 ease-in-out">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="flex-1 p-6 overflow-auto">
                <div id="modalContent" class="h-full">
                    <!-- Resource Content -->
                    <div id="resourceContent" class="border p-6 rounded-lg shadow-md mb-6">
                        <!-- Content will be loaded here based on selection -->
                    </div>
                    
                    <!-- Resource Metadata -->
                    <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                        <h4 class="text-xl font-semibold mb-4">Resource Metadata</h4>
                        <div id="resourceMetadata" class="grid grid-cols-2 gap-4">
                            <!-- Metadata will be loaded here based on selection -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        
<script>
    const tabLinks = document.querySelectorAll('#mainTabs a');
    const tabContents = document.querySelectorAll('.tab-content');

    tabLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const tabId = link.getAttribute('data-tab');
            
            tabLinks.forEach(l => l.classList.remove('active', 'border-b-2', 'border-blue-500'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            link.classList.add('active', 'border-b-2', 'border-blue-500');
            document.getElementById(tabId).classList.add('active');
        });
    });      
    
    function showAddResourceModal() {
        document.getElementById('addResourceModal').classList.remove('hidden');
        document.getElementById('addResourceModal').classList.add('flex');
    }

    function closeAddResourceModal() {
        document.getElementById('addResourceModal').classList.add('hidden');
        document.getElementById('addResourceModal').classList.remove('flex');
    }

    function editResource(id) {
        // Implement edit functionality
        console.log('Editing resource with id:', id);
    }

    function previewResource(id) {
        // Implement preview functionality
        console.log('Previewing resource with id:', id);
    }

    function deleteResource(id) {
        // Implement delete functionality
        console.log('Deleting resource with id:', id);
    }
</script>



<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script>
    AOS.init();
    const scorm_url = "{{ course.scorm_url|escapejs }}";
    const resources = [
        {% for resource in learning_resources %}
        {
            type: '{{ resource.resource_type|lower }}',
            title: '{{ resource.title|escapejs }}',
            icon: getIconForResourceType('{{ resource.resource_type }}'),
            content: getContentForResourceType('{{ resource.resource_type }}', '{{ resource.content.url|default:""|escapejs }}', '{{ resource.external_url|default:""|escapejs }}'),
            metadata: {
                'Type': '{{ resource.get_resource_type_display }}',
                'Created': '{{ resource.created_at|date:"F d, Y" }}',
                'Last Updated': '{{ resource.updated_at|date:"F d, Y" }}',
                'Order': '{{ resource.order }}',
                {% if resource.resource_type == 'DOCUMENT' %}
                'File Type': 'NA',
                {% elif resource.resource_type == 'VIDEO' %}
                'Duration': 'N/A', // You'd need to implement video duration extraction
                {% elif resource.resource_type == 'QUIZ' %}
                'Questions': 'N/A', // You'd need to implement quiz question count
                {% endif %}
            }
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];

    function getIconForResourceType(type) {
        const iconMap = {
            'SCORM': 'fas fa-cube',
            'VIDEO': 'fas fa-video',
            'DOCUMENT': 'fas fa-file-alt',
            'PRESENTATION': 'fas fa-file-powerpoint',
            'LINK': 'fas fa-link',
            'QUIZ': 'fas fa-question-circle'
        };
        return iconMap[type] || 'fas fa-file';
    }

    function getContentForResourceType(type, contentUrl, externalUrl) {
        switch (type) {
            case 'VIDEO':
                return `<div class="aspect-w-16" data-aos="fade-up"><video src="${contentUrl}" controls class="w-full"></video></div>`;
            case 'DOCUMENT':
                return `<div class="bg-gray-100 p-6 rounded-lg" data-aos="fade-up"><p class="font-bold mb-4">Document Preview</p><p>This is a preview of the document. <a href="${contentUrl}" target="_blank" class="text-blue-500 hover:underline">View full document</a></p></div>`;
            case 'QUIZ':
                return `<div class="bg-gray-100 p-6 rounded-lg" data-aos="fade-up"><p class="font-bold mb-4">Quiz Preview</p><p>This quiz is available in the course. Click to attempt.</p></div>`;
            case 'SCORM':
                return `<div class="bg-gray-200 p-6 rounded-lg text-center" data-aos="fade-up"><p class="mb-4">This is a SCORM package. Click the button below to launch it.</p><button class="bg-blue-500 text-white px-6 py-2 rounded-full shadow hover:bg-blue-600 transition duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-105">Launch SCORM Package</button></div>`;
            case 'PRESENTATION':
                return `<div class="bg-gray-100 p-6 rounded-lg text-center" data-aos="fade-up"><p class="font-bold mb-4">Presentation Preview</p><p>This is a presentation. <a href="${contentUrl}" target="_blank" class="text-blue-500 hover:underline">View presentation</a></p></div>`;
            case 'LINK':
                return `<div class="bg-gray-100 p-6 rounded-lg" data-aos="fade-up"><p class="font-bold mb-4">External Resource</p><a href="${externalUrl}" target="_blank" class="text-blue-500 hover:underline">${externalUrl}</a><p class="mt-4">Click the link above to access the external resource. Please note that this will open in a new tab.</p></div>`;
            default:
                return `<div class="bg-gray-100 p-6 rounded-lg" data-aos="fade-up"><p class="font-bold mb-4">Resource Preview</p><p>Preview not available for this resource type.</p></div>`;
        }
    }

    function previewResource() {
        const modal = document.getElementById('previewModal');
        modal.classList.remove('hidden');
        renderLearningPath();
        showResource(0);
    }

    function renderLearningPath() {
        const pathContainer = document.getElementById('learningPath');
        pathContainer.innerHTML = resources.map((resource, index) => `
            <div class="learning-path-item flex items-start p-2 cursor-pointer hover:bg-gray-200 rounded transition duration-300 ease-in-out" onclick="showResource(${index})">
                <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3 z-10">
                    ${index + 1}
                </div>
                <div>
                    <h4 class="font-semibold">${resource.title}</h4>
                    <p class="text-sm text-gray-600"><i class="${resource.icon} mr-1"></i>${resource.type}</p>
                </div>
            </div>
        `).join('');
    }

    function showResource(index) {
        const resource = resources[index];
        const contentDiv = document.getElementById('resourceContent');
        const metadataDiv = document.getElementById('resourceMetadata');
        const modalTitle = document.getElementById('modalTitle');
        
        modalTitle.textContent = resource.title;
        
        if (resource.type === 'scorm') {
            contentDiv.innerHTML = `
                <div class="bg-gray-200 p-6 rounded-lg text-center" data-aos="fade-up">
                    <p class="mb-4">This is a SCORM package. Click the button below to launch the course.</p>
                    <button onclick="launchScorm('${scorm_url}')" class="bg-blue-500 text-white px-6 py-2 rounded-full shadow hover:bg-blue-600 transition duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-105">
                        Launch SCORM Package
                    </button>
                </div>
            `;
        } else {
            contentDiv.innerHTML = resource.content;
        }
        
        metadataDiv.innerHTML = Object.entries(resource.metadata).map(([key, value]) => 
            `<div data-aos="fade-up" data-aos-delay="100"><strong class="text-gray-700">${key}:</strong> ${value}</div>`
        ).join('');
        
        // Highlight active item in learning path
        document.querySelectorAll('.learning-path-item').forEach((item, i) => {
            if (i === index) {
                item.classList.add('bg-blue-100');
            } else {
                item.classList.remove('bg-blue-100');
            }
        });
        
        AOS.refresh();
    }

    function launchScorm(url) {
        const contentDiv = document.getElementById('resourceContent');
        const metadataDiv = document.getElementById('resourceMetadata');
        
        // Hide the metadata section
        metadataDiv.classList.add('hidden');
        
        // Expand the content div to full height
        contentDiv.classList.add('h-full');
        
        contentDiv.innerHTML = `
            <div class="w-full h-full flex flex-col">
                <iframe src="${url}" allowfullscreen class="w-full flex-grow border-none"></iframe>
            </div>
        `;
    }

    function closeModal() {
        const modal = document.getElementById('previewModal');
        modal.classList.add('hidden');
    }

    // Close modal when clicking outside
    document.getElementById('previewModal').addEventListener('click', function(event) {
        if (event.target === this) {
            closeModal();
        }
    });
</script>
{% endblock %}