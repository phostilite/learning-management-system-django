{% extends '../_base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Help & Support - LMS Admin" %}{% endblock %}

{% block extra_css %}
{% endblock %}

{% block content %}

<div class="help-support-page" dir="{{ LANGUAGE_BIDI|yesno:"rtl,ltr" }}">
    <!-- Header -->
    <header class="gradient-bg text-white p-6 rounded-xl mb-4 card-shadow relative overflow-hidden">
        <div class="relative z-10">
            <h1 class="text-4xl font-bold text-center mb-2">{% trans "Help & Support Center" %}</h1>
            <p class="text-center text-lg">{% trans "Manage Support Tickets and Access Resources" %}</p>
        </div>
        <div class="absolute inset-0"></div>
    </header>

    <!-- Breadcrumb -->
    <nav class="flex mb-4" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3 rtl:space-x-reverse">
            <li class="inline-flex items-center">
                <a href="{% url 'administrator_dashboard' %}" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600">
                    <svg class="w-4 h-4 mr-2 rtl:ml-2 rtl:mr-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
                    {% trans "Dashboard" %}
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400 rtl:rotate-180" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                    <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">{% trans "Help & Support" %}</span>
                </div>
            </li>
        </ol>
    </nav>

    <!-- Support Statistics -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Open Tickets" %}</h3>
            <p class="text-3xl font-bold text-primary">24</p>
        </div>
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Avg. Response Time" %}</h3>
            <p class="text-3xl font-bold text-accent">2.5h</p>
        </div>
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Resolved This Week" %}</h3>
            <p class="text-3xl font-bold text-green-600">87</p>
        </div>
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "User Satisfaction" %}</h3>
            <p class="text-3xl font-bold text-yellow-500">94%</p>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <a href="{% url 'administrator_tickets_create' %}" class="bg-primary text-white p-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 flex items-center justify-center">
            <svg class="w-6 h-6 mr-2 rtl:ml-2 rtl:mr-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            {% trans "Create New Ticket" %}
        </a>
        <button class="bg-accent text-white p-4 rounded-lg hover:bg-accent focus:outline-none focus:ring-2 focus:ring-accent focus:ring-opacity-50 flex items-center justify-center">
            <svg class="w-6 h-6 mr-2 rtl:ml-2 rtl:mr-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
            {% trans "View Knowledge Base" %}
        </button>
        <button class="bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-opacity-50 flex items-center justify-center">
            <svg class="w-6 h-6 mr-2 rtl:ml-2 rtl:mr-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
            </svg>
            {% trans "Live Chat Support" %}
        </button>
    </div>

    <!-- Recent Support Tickets -->
    <div class="bg-white rounded-lg card-shadow overflow-hidden mb-6">
        <div class="p-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold">{% trans "Recent Support Tickets" %}</h2>
        </div>
        <table class="w-full text-sm text-left rtl:text-right text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                <tr>
                    <th scope="col" class="px-6 py-3">{% trans "Title" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Description" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Status" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Priority" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Created By" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Assigned To" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Created At" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Updated At" %}</th>
                    <th scope="col" class="px-6 py-3">{% trans "Actions" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for ticket in support_tickets %}
                <tr class="bg-white border-b hover:bg-gray-50">

                    <td class="px-6 py-4">{{ ticket.title }}</td>
                    <td class="px-6 py-4">{{ ticket.description|slice:":10" }}</td>
                    <td class="px-6 py-4">
                        {% if ticket.status == 'OPEN' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-green-700 bg-green-100 rounded-full">
                                {{ ticket.get_status_display }}
                            </span>
                        {% elif ticket.status == 'IN_PROGRESS' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-blue-700 bg-blue-100 rounded-full">
                                {{ ticket.get_status_display }}
                            </span>
                        {% elif ticket.status == 'RESOLVED' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-yellow-700 bg-yellow-100 rounded-full">
                                {{ ticket.get_status_display }}
                            </span>
                        {% elif ticket.status == 'CLOSED' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-red-700 bg-red-100 rounded-full">
                                {{ ticket.get_status_display }}
                            </span>
                        {% else %}
                            <span class="px-2 py-1 font-semibold leading-tight text-gray-700 bg-gray-100 rounded-full">
                                {{ ticket.get_status_display }}
                            </span>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4">
                        {% if ticket.priority == 'LOW' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-green-700 bg-green-100 rounded-full">
                                {{ ticket.get_priority_display }}
                            </span>
                        {% elif ticket.priority == 'MEDIUM' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-blue-700 bg-blue-100 rounded-full">
                                {{ ticket.get_priority_display }}
                            </span>
                        {% elif ticket.priority == 'HIGH' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-yellow-700 bg-yellow-100 rounded-full">
                                {{ ticket.get_priority_display }}
                            </span>
                        {% elif ticket.priority == 'URGENT' %}
                            <span class="px-2 py-1 font-semibold leading-tight text-red-700 bg-red-100 rounded-full">
                                {{ ticket.get_priority_display }}
                            </span>
                        {% else %}
                            <span class="px-2 py-1 font-semibold leading-tight text-gray-700 bg-gray-100 rounded-full">
                                {{ ticket.get_priority_display }}
                            </span>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4">
                        {% if ticket.created_by %}
                            <div>
                                {% if ticket.created_by.first_name %}
                                    <p>{{ ticket.created_by.first_name }} {{ ticket.created_by.last_name }} </p>
                                {% endif %}
                                {% if ticket.created_by.email %}
                                    <p>{{ ticket.created_by.email }}</p>
                                {% endif %}
                            </div>
                        {% else %}
                            <p>No creator information available.</p>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4">
                        {% if ticket.assigned_to %}
                            <div>
                                <p>{{ ticket.assigned_to.first_name }} {{ ticket.assigned_to.last_name }}</p>
                            </div>
                        {% else %}
                            <p>Unassigned</p>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4">
                        <p>{{ ticket.created_at|date:"Y-m-d H:i" }}</p>
                    </td>
                    <td class="px-6 py-4">
                        <p>{{ ticket.updated_at|date:"Y-m-d H:i" }}</p>
                    </td>
                    <td class="px-6 py-4">
                        <a href="{% url 'administrator_tickets_detail' ticket.id %}" class="text-blue-600 hover:text-blue-900" title="{% trans 'View Ticket' %}">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'administrator_ticket_edit' ticket.id %}" class="text-blue-600 hover:text-blue-900" title="{% trans 'Edit' %}">
                            <i class="fas fa-pen"></i>
                        </a>
                        <a href="{% url 'administrator_ticket_delete' ticket.id %}" class="text-blue-600 hover:text-red-900" title="{% trans 'Delete' %}">
                            <i class="fas fa-circle"></i>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- FAQ Section -->
    <div class="bg-white rounded-lg card-shadow overflow-hidden mb-6">
        <div class="p-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold">{% trans "Frequently Asked Questions" %}</h2>
        </div>
        <div class="p-4">
            <div class="mb-4">
                <h3 class="font-semibold mb-2">{% trans "How do I reset a student's password?" %}</h3>
                <p class="text-gray-600">{% trans "To reset a student's password, go to User Management, find the student's profile, and click on the 'Reset Password' button. An email with instructions will be sent to the student." %}</p>
            </div>
            <div class="mb-4">
                <h3 class="font-semibold mb-2">{% trans "How can I add a new course to the system?" %}</h3>
                <p class="text-gray-600">{% trans "To add a new course, navigate to the Courses section, click on 'Add New Course', fill in the required information, and upload course materials. Don't forget to assign instructors and set the course schedule." %}</p>
            </div>
            <!-- Add more FAQs as needed -->
        </div>
    </div>

    <!-- Help Resources -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Video Tutorials" %}</h3>
            <ul class="list-disc list-inside text-gray-600">
                <li>{% trans "Getting Started Guide" %}</li>
                <li>{% trans "Advanced User Management" %}</li>
                <li>{% trans "Customizing Your LMS" %}</li>
            </ul>
        </div>
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Documentation" %}</h3>
            <ul class="list-disc list-inside text-gray-600">
                <li>{% trans "Administrator Manual" %}</li>
                <li>{% trans "API Documentation" %}</li>
                <li>{% trans "Troubleshooting Guide" %}</li>
            </ul>
        </div>
        <div class="bg-white rounded-lg p-4 card-shadow">
            <h3 class="text-lg font-semibold mb-2">{% trans "Community Forum" %}</h3>
            <p class="text-gray-600">{% trans "Join our community forum to connect with other administrators, share experiences, and get answers to your questions." %}</p>
            <a href="#" class="text-blue-600 hover:text-blue-800 mt-2 inline-block">{% trans "Visit Forum" %} →</a>
        </div>
    </div>
</div>

{% endblock %}